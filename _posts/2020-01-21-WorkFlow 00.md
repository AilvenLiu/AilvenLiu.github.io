---
layout:     post
title:      WorkFlow 框架学习笔记 -- 00          
subtitle:   CMake 基本语法               
date:       2022-04-20
author:     OUC_LiuX
header-img: img/wallpic02.jpg
catalog: true
tags:     
    - WebServer      
    - Ubuntu OS
---      

由于我的 workflow 是从 github 上面 down 下来，`mkdir build` 后自行 `cmake .. && make` 编译的，既不是通过 apt 安装，也没有执行 `make install`，编译完的源码没有加入到 `/usr/local/include` 等系统路径，于是写自己的 workflow C++ 程序的时候没有办法直接 `#include <workflow/WFxxx.h>` 来引入相关包，只能通过 g++ 参数或 cmake 方法指定头文件和链接文件。      

下面先给出我的 `CMakeLists.txt` 文件，然后逐行解释语法和功能。             

**代码：**             
```cmake    
cmake_minimum_required(VERSION 3.6)

set(CMAKE_BUILD_TYPE RelWithDebInfo)

project(helloworld
		LANGUAGES C CXX
)

# set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR})         

find_library(LIBRT rt)
message(STATUS "LIBRT = ${LIBRT}")

find_package(OpenSSL REQUIRED)

message(STATUS "OpenSSL_DIR = ${OPENSSL_DIRS}")
message(STATUS "OpenSSL_INCLUDE_DIRS = ${OPENSSL_INCLUDE_DIR}")
message(STATUS "OpenSSL_LIBS = ${OPENSSL_LIB_DIRS}")

set(WORKFLOW_INCLUDE_DIR /home/ailven//data/cppProj/workflow/_include)
set(WORKFLOW_LIB_DIR /home/ailven//data/cppProj/workflow/_lib)
set(workflow WORKFLOW_INCLUDE_DIR WORKFLOW_LIB_DIR)
# find_package(workflow REQUIRED CONFIG HINTS ..)           

include_directories(${OPENSSL_INCLUDE_DIR} ${WORKFLOW_INCLUDE_DIR})
link_directories(${WORKFLOW_LIB_DIR})

message(STATUS "workflow_DIR = ${WORKFLOW_DIRS}")
message(STATUS "workflow_INCLUDE_DIRS = ${WORKFLOW_INCLUDE_DIR}")
message(STATUS "workflow_LIBS = ${WORKFLOW_LIB_DIR}")

if (KAFKA STREQUAL "y")
	find_path(SNAPPY_INCLUDE_PATH NAMES snappy.h)
	include_directories(${SNAPPY_INCLUDE_PATH})
endif ()

set(CMAKE_C_FLAGS   "${CMAKE_C_FLAGS}   -Wall -fPIC -pipe -std=gnu90")
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -fPIC -pipe -std=c++11 -fno-exceptions")


set(WORKFLOW_LIB workflow pthread OpenSSL::SSL OpenSSL::Crypto ${LIBRT})

aux_source_directory(. SRC_LISTS)
add_executable(${PROJECT_NAME} ${SRC_LISTS})
target_link_libraries(${PROJECT_NAME} ${WORKFLOW_LIB})
```

**逐行解释：**             

```cmake       
cmake_minimum_required(VERSION 3.6)
```       
指定 cmake 最低版本，如果低于这个版本，直接报错退出。           


```cmake 
set(CMAKE_BUILD_TYPE RelWithDebInfo)
```        
指定编译类别/级别（`CMAKE_BUILD_TYPE`）为 `RelWithDebInfo`。CMake 具有以下四种编译级别：           
1. `Release`： 不可以打断点调试，程序开发完成后发行使用的版本，占的体积小。 它对代码做了优化，因此速度会非常快，在编译器中使用命令： `-O3 -DNDEBUG` 可选择此版本。        
2. `Debug`： 调试的版本，体积大。在编译器中使用命令： `-g` 可选择此版本。           
3. `MinSizeRel`： 最小体积版本，在编译器中使用命令：`-Os -DNDEBUG` 可选择此版本。       
4. `RelWithDebInfo`： 既优化又能调试。在编译器中使用命令：`-O2 -g -DNDEBUG` 可选择此版本。          


```cmake 
project(helloworld
		LANGUAGES C CXX
)
```
指定项目名称为 helloworld，同时生成一个变量 `PROJECT_NAME` 存储这个名字。       
指定编译语言为 C/C++。         


